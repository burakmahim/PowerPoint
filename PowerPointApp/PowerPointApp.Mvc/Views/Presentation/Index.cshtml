@{
    ViewBag.Title = "Sunum Oluştur";
    var xml = ViewBag.XmlContent as string ?? "";
}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />

<div class="container mt-5">
    <h2 class="mb-4">XML ile Sunum Oluştur</h2>

    @if (ViewBag.Error != null)
    {
        <div class="alert alert-danger">@ViewBag.Error</div>
    }

<textarea id="xmlContent" rows="15" class="form-control">@xml</textarea>

    <form id="pptxForm" method="post" action="/Presentation/DownloadPptx">
        <input type="hidden" name="xmlContent" id="pptxXmlContent" />
        <button type="submit" class="btn btn-primary">PowerPoint Olarak İndir</button>
    </form>

    <form id="pdfForm" method="post" action="/Presentation/ViewPdf" target="_blank">
        <input type="hidden" name="xmlContent" id="pdfXmlContent" />
        <button type="submit" class="btn btn-success mt-2">PDF Olarak Görüntüle</button>
    </form>





    <div class="mt-4">
        <h6>📌 Örnek XML:</h6>
        <pre class="bg-white border p-3 rounded">
&lt;presentation&gt;
  &lt;settings&gt;
    &lt;masterBackground r="255" g="255" b="255" /&gt;
  &lt;/settings&gt;
  &lt;slide&gt;
    &lt;title&gt;Merhaba Dünya&lt;/title&gt;
    &lt;body&gt;Bu bir örnek sunumdur.&lt;/body&gt;
    &lt;footer&gt;Sunumun Alt Bilgisi&lt;/footer&gt;
  &lt;/slide&gt;
&lt;/presentation&gt;
    </pre>
    </div>


    @{
        ViewBag.Title = "Excel Oluştur";
    }

    <h2>Excel Oluştur</h2>

    @using (Html.BeginForm("GenerateExcelFromXml", "Presentation", FormMethod.Post))
    {
        @Html.AntiForgeryToken()

        <div class="form-group">
            <label for="xmlContent">Excel XML İçeriği</label>
            <textarea name="xmlContent" rows="20" class="form-control" style="font-family: monospace;"></textarea>
        </div>

        <button type="submit" class="btn btn-success mt-3">Excel Oluştur ve İndir</button>

        <div class="mt-4">
            <h6>📌 Örnek Excel XML (Tablo + Grafik):</h6>
            <pre class="bg-light border p-3 rounded">
&lt;excel&gt;
  &lt;sheet name="Satış Verileri"&gt;

    &lt;table startCell="A1"&gt;
      &lt;row&gt;
        &lt;cell bold="true"&gt;Ay&lt;/cell&gt;
        &lt;cell bold="true"&gt;Elma&lt;/cell&gt;
        &lt;cell bold="true"&gt;Armut&lt;/cell&gt;
      &lt;/row&gt;
      &lt;row&gt;
        &lt;cell&gt;Ocak&lt;/cell&gt;
        &lt;cell&gt;100&lt;/cell&gt;
        &lt;cell&gt;80&lt;/cell&gt;
      &lt;/row&gt;
      &lt;row&gt;
        &lt;cell&gt;Şubat&lt;/cell&gt;
        &lt;cell&gt;120&lt;/cell&gt;
        &lt;cell&gt;90&lt;/cell&gt;
      &lt;/row&gt;
      &lt;row&gt;
        &lt;cell&gt;Mart&lt;/cell&gt;
        &lt;cell&gt;140&lt;/cell&gt;
        &lt;cell&gt;100&lt;/cell&gt;
      &lt;/row&gt;
    &lt;/table&gt;

    &lt;chart type="Column" title="Satış Grafiği" xAxis="Ay" yAxis="Tutar"&gt;
      &lt;series name="Elma"&gt;
        &lt;point label="Ocak" value="100" /&gt;
        &lt;point label="Şubat" value="120" /&gt;
        &lt;point label="Mart" value="140" /&gt;
      &lt;/series&gt;
      &lt;series name="Armut"&gt;
        &lt;point label="Ocak" value="80" /&gt;
        &lt;point label="Şubat" value="90" /&gt;
        &lt;point label="Mart" value="100" /&gt;
      &lt;/series&gt;
    &lt;/chart&gt;

  &lt;/sheet&gt;
&lt;/excel&gt;
    </pre>
        </div>
    }



    <script>
        document.getElementById("pptxForm").addEventListener("submit", function () {
            document.getElementById("pptxXmlContent").value = document.getElementById("xmlContent").value;
        });

        document.getElementById("pdfForm").addEventListener("submit", function () {
            document.getElementById("pdfXmlContent").value = document.getElementById("xmlContent").value;
        });
    </script>
