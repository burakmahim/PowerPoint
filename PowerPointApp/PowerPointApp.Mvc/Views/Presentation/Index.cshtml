@{
    ViewBag.Title = "Sunum ve Excel Oluştur";
    var xml = ViewBag.XmlContent as string ?? "";
}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />

<div class="container mt-5">
    <h1 class="text-center mb-4">📄 XML'den PowerPoint ve Excel Oluştur</h1>

    @if (ViewBag.Error != null)
    {
        <div class="alert alert-danger">@ViewBag.Error</div>
    }


    <!-- PowerPoint Formları -->
<div class="card mb-5">
    <div class="card-header bg-primary text-white">
        🎞️ PowerPoint Oluştur
    </div>
    <!-- Ortak XML Textarea -->
    <div class="mb-4">
        <label for="xmlContent" class="form-label fw-semibold">PowerPoint XML İçeriği</label>
        <textarea id="xmlContent" name="xmlContent"
                  class="form-control"
                  rows="15"
                  style="font-family: monospace; width: 95vw; max-width: 95%;"></textarea>
    </div>





    <div class="card-body">
        <form id="pptxForm" method="post" action="/Presentation/DownloadPptx">
            <input type="hidden" name="xmlContent" id="pptxXmlContent" />
            <button type="submit" class="btn btn-primary">PowerPoint Olarak İndir</button>
        </form>

        <form id="pdfForm" method="post" action="/Presentation/ViewPdf" target="_blank" class="mt-2">
            <input type="hidden" name="xmlContent" id="pdfXmlContent" />
            <button type="submit" class="btn btn-success">PDF Olarak Görüntüle</button>
        </form>

        <div class="mt-4 w-90">
            <h6>📌 Örnek PowerPoint XML:</h6>
            <pre class="bg-light border p-3 rounded small">
                    &lt;presentation&gt;
                      &lt;settings&gt;
                        &lt;masterBackground r="255" g="255" b="255" /&gt;
                      &lt;/settings&gt;
                      &lt;slide&gt;
                        &lt;title&gt;Merhaba Dünya&lt;/title&gt;
                        &lt;body&gt;Bu bir örnek sunumdur.&lt;/body&gt;
                        &lt;footer&gt;Sunumun Alt Bilgisi&lt;/footer&gt;
                      &lt;/slide&gt;
                    &lt;/presentation&gt;
            </pre>
        </div>
    </div>
</div>

    <!-- Excel Formu -->
    <div class="card mb-5">
        <div class="card-header bg-success text-white">
            📊 Excel Oluştur
        </div>
        <div class="card-body">
            @using (Html.BeginForm("GenerateExcelFromXml", "Presentation", FormMethod.Post))
            {
                @Html.AntiForgeryToken()

                <div class="form-group w-100">
                    <label for="xmlContentExcel" class="fw-semibold">Excel XML İçeriği</label>
                    <textarea name="xmlContent"
                              id="xmlContentExcel"
                              rows="15"
                              class="form-control"
                              style="font-family: monospace; width: 95vw; max-width: 95%;"></textarea>
                </div>


                <button type="submit" class="btn btn-success mt-3">Excel Oluştur ve İndir</button>
            }

            <div class="mt-4 w-90">
                <h6>📌 Örnek Excel XML (Tablo + Grafik):</h6>
                <pre class="bg-light border p-3 rounded small">
                &lt;excel&gt;
                  &lt;sheet name="Satış Verileri"&gt;
                    &lt;table startCell="A1"&gt;
                      &lt;row&gt;
                        &lt;cell bold="true"&gt;Ay&lt;/cell&gt;
                        &lt;cell bold="true"&gt;Elma&lt;/cell&gt;
                        &lt;cell bold="true"&gt;Armut&lt;/cell&gt;
                      &lt;/row&gt;
                      &lt;row&gt;
                        &lt;cell&gt;Ocak&lt;/cell&gt;
                        &lt;cell&gt;100&lt;/cell&gt;
                        &lt;cell&gt;80&lt;/cell&gt;
                      &lt;/row&gt;
                      &lt;row&gt;
                        &lt;cell&gt;Şubat&lt;/cell&gt;
                        &lt;cell&gt;120&lt;/cell&gt;
                        &lt;cell&gt;90&lt;/cell&gt;
                      &lt;/row&gt;
                    &lt;/table&gt;

                    &lt;chart type="Column" title="Satış Grafiği" xAxis="Ay" yAxis="Tutar"&gt;
                      &lt;series name="Elma"&gt;
                        &lt;point label="Ocak" value="100" /&gt;
                        &lt;point label="Şubat" value="120" /&gt;
                      &lt;/series&gt;
                    &lt;/chart&gt;
                  &lt;/sheet&gt;
                &lt;/excel&gt;
                </pre>
            </div>
        </div>
    </div>
</div>

<!-- JavaScript: Textarea içeriğini gizli inputlara aktarma -->
<script>
    document.getElementById("pptxForm").addEventListener("submit", function () {
        document.getElementById("pptxXmlContent").value = document.getElementById("xmlContent").value;
    });

    document.getElementById("pdfForm").addEventListener("submit", function () {
        document.getElementById("pdfXmlContent").value = document.getElementById("xmlContent").value;
    });
</script>
